<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Blockly JavaScript Playground</title>
  <script src="https://unpkg.com/blockly/blockly.min.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
    }
    #blocklyDiv {
      height: 70%;
      width: 100%;
    }
    #codeArea {
      height: 20%;
      width: 100%;
      padding: 10px;
      background: #f0f0f0;
      font-family: monospace;
      overflow: auto;
      border-top: 2px solid #ccc;
    }
    #buttons {
      padding: 10px;
      background: #e8e8e8;
    }
    button {
      font-size: 16px;
      margin-right: 10px;
    }
  </style>
</head>
<body>

<div id="blocklyDiv"></div>

<div id="buttons">
  <button onclick="runCode()">Run</button>
  <button onclick="showCode()">Show JS</button>
</div>

<pre id="codeArea">// JavaScript code appears here</pre>

<xml id="toolbox" style="display: none">
  <category name="Logic" colour="210">
    <block type="controls_if"></block>
    <block type="logic_compare"></block>
  </category>
  <category name="Loops" colour="120">
    <block type="controls_repeat_ext">
      <value name="TIMES"><shadow type="math_number"><field name="NUM">10</field></shadow></value>
    </block>
    <block type="controls_whileUntil"></block>
  </category>
  <category name="Math" colour="230">
    <block type="math_number"><field name="NUM">123</field></block>
    <block type="math_arithmetic"></block>
  </category>
  <category name="Text" colour="160">
    <block type="text"></block>
    <block type="text_print"></block>
  </category>
  <category name="Variables" custom="VARIABLE" colour="330"></category>
</xml>

<script>
  const workspace = Blockly.inject('blocklyDiv', {
    toolbox: document.getElementById('toolbox')
  });

  function showCode() {
    const code = Blockly.JavaScript.workspaceToCode(workspace);
    document.getElementById('codeArea').textContent = code;
  }

  function runCode() {
    try {
      const code = Blockly.JavaScript.workspaceToCode(workspace);
      document.getElementById('codeArea').textContent = code;
      new Function(code)();
    } catch (e) {
      alert("Error:\n" + e);
    }
  }
</script>

</body>
</html>
